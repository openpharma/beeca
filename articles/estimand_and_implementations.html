<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="beeca">
<title>Introduction to estimating a marginal estimand with beeca • beeca</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to estimating a marginal estimand with beeca">
<meta property="og:description" content="beeca">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">beeca</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/estimand_and_implementations.html">Introduction to estimating a marginal estimand with beeca</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Introduction to estimating a marginal estimand with beeca</h1>
            
      
      
      <div class="d-none name"><code>estimand_and_implementations.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <a href="https://www.ema.europa.eu/en/documents/scientific-guideline/ich-e9-r1-addendum-estimands-sensitivity-analysis-clinical-trials-guideline-statistical-principles_en.pdf" class="external-link">ICH
E9(R1) addendum</a> proposed a framework for the formulation of
scientific questions and treatment effects in clinical trials. The
framework emphasized the importance of formulating precisely the
scientific questions of interest in clinical trials in the form of an
estimand. An estimand describes the treatment effect of interest via
five attributes, which include treatment, population, variable
(endpoint), intercurrent event and population-level summary.</p>
<p>Recent <a href="https://www.fda.gov/regulatory-information/search-fda-guidance-documents/adjusting-covariates-randomized-clinical-trials-drugs-and-biological-products" class="external-link">FDA
guidance (2023)</a> on <em>Adjusting for Covariates in Randomized
Clinical Trials for Drugs and Biological Products for Industry</em>
discussed various considerations when prospectively specifying
covariate-adjusted analysis, including the distinction between
<em>unconditional</em> vs. <em>conditional</em> average treatment
effects.</p>
<p>This vignette provides</p>
<ol style="list-style-type: decimal">
<li>A brief explanation of the different concepts on average treatment
effect covered in the package.</li>
<li>An analysis example using the package to estimate an average
treatment effect in a clinical trial with covariate adjustment.</li>
<li>A comparison with other implementations of the methods.</li>
</ol>
</div>
<div class="section level2">
<h2 id="general-concepts">General concepts<a class="anchor" aria-label="anchor" href="#general-concepts"></a>
</h2>
<div class="section level3">
<h3 id="what-is-an-average-treatment-effect">What is an average treatment effect?<a class="anchor" aria-label="anchor" href="#what-is-an-average-treatment-effect"></a>
</h3>
<p>In general, an average treatment effect is the effect of moving
<strong>a</strong> population from untreated (control treatment) to
treated (experimental treatment). An average treatment effect can be
estimated either with or without covariate adjustment.</p>
<p>Different flavours of average treatment effect exist, depending on
the specific population that is moved from untreated to treated. For an
overall superpopulation (denoted <span class="math inline">\(S\)</span>), and for a given sample of patients in
the trial (who are assumed to be randomly sampled from the
superpopulation), we define the following potential estimands.</p>
<ol style="list-style-type: decimal">
<li>Population Average Treatment Effect <span class="math inline">\(\mathrm{PATE}^S\)</span>. The average outcome of
everyone in the superpopulation if they were treated with the
experimental treatment vs. the average outcome if they were treated with
the control treatment.</li>
<li>Conditional Average Treatment Effect, <span class="math inline">\(\mathrm{CATE}^S(x)\)</span>. The average outcome
of everyone in the superpopulation with covariate value <span class="math inline">\(x\)</span> if they were treated with the
experimental treatment vs. the average outcome if they were treated with
the control treatment.</li>
<li>Conditional Population Average Treatment Effect <span class="math inline">\(\mathrm{CPATE}^S\)</span>. The average of <span class="math inline">\(\mathrm{CATE}^S(x_i)\)</span> for the patients
<span class="math inline">\(i=1,\ldots,N\)</span> in the trial sample.
Can also be thought of as the expected difference in outcome means
(experimental vs. control), conditional on the baseline covariates <span class="math inline">\(x_1,\ldots,x_N\)</span>.</li>
<li>Sample Average Treatment Effect <span class="math inline">\(\mathrm{SATE}\)</span>. The average outcome of
everyone in the trial if they were treated with the experimental
treatment vs. the average outcome if they were treated with the control
treatment.</li>
</ol>
<p>In the FDA guidance, and in other recent discussions on covariate
adjustment, average treatment effects are often classified as either
<em>unconditional</em> or <em>conditional</em>. (Sometimes
<em>marginal</em> is used interchangeably with <em>unconditional</em>).
In this context, what is usually meant by “conditional” is <span class="math inline">\(\mathrm{CATE}^S(x)\)</span>. That is, a subgroup
specific average treatment effect. Often, an assumption is made that
subgroup specific average treatment effects are identical across
subgroups. If this assumption is wrong, then interpretation can be
challenging. What is usually meant by “unconditional” (or “marginal”) is
an average of subgroup-specific average treatment effects. This second
averaging step gives corresponding estimation procedures a level of
robustness to model misspecification. Hence the following distinction in
the FDA guidance:</p>
<ol style="list-style-type: decimal">
<li>Sponsors can perform covariate-adjusted estimation and inference for
an unconditional treatment effect in the primary analysis of data from a
randomized trial.</li>
<li>Sponsors should discuss with the relevant review divisions specific
proposals in a protocol or statistical analysis plan containing
nonlinear regression to estimate conditional treatment effects for the
primary analysis.</li>
</ol>
<p>Under the coarse classification of average treatment effects as
either “unconditional / marginal” or “conditional”, the <span class="math inline">\(\mathrm{PATE}^S\)</span>, <span class="math inline">\(\mathrm{CPATE}^S\)</span> and <span class="math inline">\(\mathrm{SATE}\)</span> can be viewed as
“unconditional / marginal”, while the <span class="math inline">\(\mathrm{CATE}^S(x)\)</span> can be viewed as
“conditional”.</p>
</div>
<div class="section level3">
<h3 id="how-to-estimate-unconditional-marginal-average-treatment-effect">How to estimate “unconditional / marginal” average treatment
effect?<a class="anchor" aria-label="anchor" href="#how-to-estimate-unconditional-marginal-average-treatment-effect"></a>
</h3>
<p>For a binary endpoint, an average treatment effect, whether it be a
<span class="math inline">\(\mathrm{PATE}^S\)</span>, <span class="math inline">\(\mathrm{CPATE}^S\)</span> or <span class="math inline">\(\mathrm{SATE}\)</span>, can be estimated from an
adjusted logistic regression using the g-computation method. That is, by
estimating the average counterfactual outcomes on each arm based on
predictions from the working model. Based on these average
counterfactual outcomes, different summary measure such as risk
difference, relative risk or odds ratio can be evaluated.</p>
<p>Regardless of whether the estimand is <span class="math inline">\(\mathrm{PATE}^S\)</span>, <span class="math inline">\(\mathrm{CPATE}^S\)</span> or <span class="math inline">\(\mathrm{SATE}\)</span>, the same point estimator
can be used.</p>
</div>
<div class="section level3">
<h3 id="how-to-estimate-the-variance-of-the-g-computation-estimator-of-average-treatment-effect">How to estimate the variance of the g-computation estimator of
average treatment effect?<a class="anchor" aria-label="anchor" href="#how-to-estimate-the-variance-of-the-g-computation-estimator-of-average-treatment-effect"></a>
</h3>
<p>To avoid ambiguity regarding how the variance of the g-computation
estimator should be calculated, it is necessary to be precise about
whether one is estimating the <span class="math inline">\(\mathrm{PATE}^S\)</span>, <span class="math inline">\(\mathrm{CPATE}^S\)</span> or <span class="math inline">\(\mathrm{SATE}\)</span>.</p>
<p>{beeca} implements variance estimation for <span class="math inline">\(\mathrm{PATE}^S\)</span> based on the methods of
<a href="https://doi.org/10.1080/24754269.2023.2205802" class="external-link">Ye et
al. (2023)</a>, and <span class="math inline">\(\mathrm{CPATE}^S\)</span> based on <a href="https://doi.org/10.1177/009286151104500409" class="external-link">Ge et
al. (2011)</a>.</p>
<p>See <a href="https://osf.io/9mp58/" class="external-link">Magirr et al. (2024)</a> for
discussion of the estimands <span class="math inline">\(\mathrm{PATE}^S\)</span> and <span class="math inline">\(\mathrm{CPATE}^S\)</span>, and the corresponding
methodology for variance estimation.</p>
</div>
</div>
<div class="section level2">
<h2 id="analysis-example">Analysis example<a class="anchor" aria-label="anchor" href="#analysis-example"></a>
</h2>
<p>In the following example, we will use an example CDISC clinical trial
dataset in ADaM format (<code><a href="../reference/trial02_cdisc.html">?trial02_cdisc</a></code>). We will only
include the two treatment arms of interest for the analysis: “Xanomeline
High Dose” and “Placebo”. Below we show how to describe and perform an
adjusted analysis targeting marginal risk difference between the two
arms.</p>
<p>A logistic regression model will be used to estimate the average
treatment effect between Xanomeline High Dose and Placebo. The model
will adjust for baseline values of patient sex, race and age. Difference
in marginal response proportions with p-value and corresponding 95%
confidence interval will be estimated from the logistic regression model
using the methodology described in Ge et al. 2011 with sandwich variance
estimator (Liu et al. 2023). The sandwich estimator provides robustness
to model-misspecification.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://openpharma.github.io/beeca/">beeca</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Prepare the dataset for input</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">trial02_cdisc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co">## In this case we are only interested in comparing two arms: Placebo vs Xanomeline High Dose</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">TRTP</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Placebo"</span>, <span class="st">"Xanomeline High Dose"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co">## Treatment variable must be coded as a factor</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>TRTP <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">TRTP</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Fit the logistic regression model adjusting for SEX, RACE and AGE</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">AVAL</span> <span class="op">~</span> <span class="va">TRTP</span> <span class="op">+</span> <span class="va">SEX</span> <span class="op">+</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">AGE</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Calculate the marginal treatment effect estimate and associated variance for a difference contrast</span></span>
<span><span class="co">## using the Ge et al. method with robust HC0 sandwich variance</span></span>
<span><span class="va">marginal_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_marginal_effect.html">get_marginal_effect</a></span><span class="op">(</span><span class="va">fit</span>,</span>
<span>  trt <span class="op">=</span> <span class="st">"TRTP"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"Ge"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"HC0"</span>,</span>
<span>  contrast <span class="op">=</span> <span class="st">"diff"</span>,</span>
<span>  reference <span class="op">=</span> <span class="st">"Placebo"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The results are summarised in ARD format (Analysis Results Dataset)
for ease of subsequent reporting.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## View the ARD summary</span></span>
<span><span class="va">marginal_fit</span><span class="op">$</span><span class="va">marginal_results</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 12 × 8</span></span></span>
<span><span class="co">##    TRTVAR TRTVAL                  PARAM ANALTYP1 STAT  STATVAL ANALMETH ANALDESC</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> TRTP   Xanomeline High Dose    AVAL  DESCRIP… N     84      count    Compute…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> TRTP   Xanomeline High Dose    AVAL  DESCRIP… n     61      count    Compute…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> TRTP   Xanomeline High Dose    AVAL  DESCRIP… %     72.6    percent… Compute…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> TRTP   Xanomeline High Dose    AVAL  INFEREN… risk   0.722  g-compu… Compute…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> TRTP   Xanomeline High Dose    AVAL  INFEREN… risk…  0.049<span style="text-decoration: underline;">3</span> Ge - HC0 Compute…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> TRTP   Placebo                 AVAL  DESCRIP… N     86      count    Compute…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> TRTP   Placebo                 AVAL  DESCRIP… n     29      count    Compute…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> TRTP   Placebo                 AVAL  DESCRIP… %     33.7    percent… Compute…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> TRTP   Placebo                 AVAL  INFEREN… risk   0.344  g-compu… Compute…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> TRTP   Placebo                 AVAL  INFEREN… risk…  0.051<span style="text-decoration: underline;">0</span> Ge - HC0 Compute…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span> TRTP   diff: Xanomeline High … AVAL  INFEREN… diff   0.378  g-compu… Compute…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">12</span> TRTP   diff: Xanomeline High … AVAL  INFEREN… diff…  0.071<span style="text-decoration: underline;">4</span> Ge - HC0 Compute…</span></span></code></pre>
<p>The results can then be passed on to the prespecified testing
strategy as required. Below we provide a simple example where normal
approximation is applied:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Extract results</span></span>
<span><span class="va">marginal_results</span> <span class="op">&lt;-</span> <span class="va">marginal_fit</span><span class="op">$</span><span class="va">marginal_results</span></span>
<span><span class="va">diff_est</span> <span class="op">&lt;-</span> <span class="va">marginal_results</span><span class="op">[</span><span class="va">marginal_results</span><span class="op">$</span><span class="va">STAT</span> <span class="op">==</span> <span class="st">"diff"</span>, <span class="st">"STATVAL"</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">diff_se</span> <span class="op">&lt;-</span> <span class="va">marginal_results</span><span class="op">[</span><span class="va">marginal_results</span><span class="op">$</span><span class="va">STAT</span> <span class="op">==</span> <span class="st">"diff_se"</span>, <span class="st">"STATVAL"</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="co">## 95% confidence interval</span></span>
<span><span class="va">ci_l</span> <span class="op">&lt;-</span> <span class="va">diff_est</span> <span class="op">-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span> <span class="op">*</span> <span class="va">diff_se</span><span class="op">)</span></span>
<span><span class="va">ci_u</span> <span class="op">&lt;-</span> <span class="va">diff_est</span> <span class="op">+</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span> <span class="op">*</span> <span class="va">diff_se</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Two-sided p-value</span></span>
<span><span class="va">z_score</span> <span class="op">&lt;-</span> <span class="va">diff_est</span> <span class="op">/</span> <span class="va">diff_se</span></span>
<span><span class="va">p_value</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">z_score</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"The risk difference is %s with 95%% CI: (%s - %s)"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diff_est</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ci_l</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ci_u</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "The risk difference is 0.38 with 95% CI: (0.24 - 0.52)"</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"p-value: %s"</span>, <span class="fu"><a href="https://rdrr.io/r/base/formatc.html" class="external-link">formatC</a></span><span class="op">(</span><span class="va">p_value</span>, format <span class="op">=</span> <span class="st">"e"</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "p-value: 1.15e-07"</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="comparing-different-implementations">Comparing different implementations<a class="anchor" aria-label="anchor" href="#comparing-different-implementations"></a>
</h2>
<p>To illustrate the usage of {beeca} and for purposes of results
validation, we compare {beeca} with other available implementations of
<a href="https://doi.org/10.1177/009286151104500409" class="external-link">Ge et
al. (2011)</a> and <a href="https://doi.org/10.1080/24754269.2023.2205802" class="external-link">Ye et
al. (2023)</a> methods in R and SAS. We demonstrate equivalence of
results while highlighting the simple user interface of {beeca}. Our
lightweight package has been developed with a focus on facilitating
quick industry adoption including compliance with GxP validation
requirements with minimal dependencies.</p>
<p>Throughout the comparisons, we use the dataset <code>trial01</code>
included in the {beeca} package and focus on the risk difference
contrast.</p>
<div class="section level3">
<h3 id="ge-et-al-2011">Ge et al (2011)<a class="anchor" aria-label="anchor" href="#ge-et-al-2011"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># pre-process trial01 dataset to convert treatment arm to a factor and handle missing value</span></span>
<span><span class="va">data01</span> <span class="op">&lt;-</span> <span class="va">trial01</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span>trtp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">trtp</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">aval</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">aval</span> <span class="op">~</span> <span class="va">trtp</span> <span class="op">+</span> <span class="va">bl_cov</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, data <span class="op">=</span> <span class="va">data01</span><span class="op">)</span></span>
<span><span class="va">beeca_ge</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_marginal_effect.html">get_marginal_effect</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">fit</span>, trt <span class="op">=</span> <span class="st">"trtp"</span>, method <span class="op">=</span> <span class="st">"Ge"</span>, </span>
<span>                                contrast <span class="op">=</span> <span class="st">"diff"</span>, reference <span class="op">=</span> <span class="st">"0"</span>, type <span class="op">=</span> <span class="st">"model-based"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Point estimate"</span>, <span class="va">beeca_ge</span><span class="op">$</span><span class="va">marginal_est</span>, <span class="st">"\nStandard error estimate"</span>, <span class="va">beeca_ge</span><span class="op">$</span><span class="va">marginal_se</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Point estimate -0.06836399 </span></span>
<span><span class="co">## Standard error estimate 0.06071641</span></span></code></pre>
<p><strong>Alternative version 1</strong>: code provided in <a href="https://doi.org/10.1177/009286151104500409" class="external-link">Ge et al. (2011)</a>
paper. Note the corresponding SAS code is also available in the
paper.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ge_var_paper</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">glmfit</span>, <span class="va">trt</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">pder</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">ahat</span>, <span class="va">vc</span>, <span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co">#### ahat: logistic regression parameters</span></span>
<span>    <span class="co">#### vc: variance-covariance matrix of ahat</span></span>
<span>    <span class="co">#### x: full model matrix of the logistic regression</span></span>
<span>    <span class="co">#### return mean of phat on x and its se</span></span>
<span>    <span class="va">phat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">x</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">ahat</span><span class="op">)</span></span>
<span>    <span class="va">pbar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">phat</span><span class="op">)</span></span>
<span>    <span class="va">pderiv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">phat</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">phat</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">x</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="va">sepbar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">pderiv</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">vc</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">pderiv</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pbar <span class="op">=</span> <span class="va">pbar</span>, sepbar <span class="op">=</span> <span class="va">sepbar</span>, pderiv <span class="op">=</span> <span class="va">pderiv</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">difP</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">glmfit</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co">#### estimate the proportion difference and its standard error</span></span>
<span>    <span class="va">df</span> <span class="op">&lt;-</span> <span class="va">glmfit</span><span class="op">$</span><span class="va">model</span></span>
<span></span>
<span>    <span class="va">vc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">glmfit</span><span class="op">)</span></span>
<span>    <span class="va">df</span><span class="op">[</span>, <span class="va">trt</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>    <span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="va">glmfit</span><span class="op">$</span><span class="va">formula</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span>    <span class="va">pderT</span> <span class="op">&lt;-</span> <span class="fu">pder</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">glmfit</span><span class="op">)</span>, <span class="va">vc</span>, <span class="va">mat</span><span class="op">)</span></span>
<span>    <span class="va">df</span><span class="op">[</span>, <span class="va">trt</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>    <span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="va">glmfit</span><span class="op">$</span><span class="va">formula</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span>    <span class="va">pderC</span> <span class="op">&lt;-</span> <span class="fu">pder</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">glmfit</span><span class="op">)</span>, <span class="va">vc</span>, <span class="va">mat</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">difb</span> <span class="op">&lt;-</span> <span class="va">pderT</span><span class="op">$</span><span class="va">pbar</span> <span class="op">-</span> <span class="va">pderC</span><span class="op">$</span><span class="va">pbar</span></span>
<span>    <span class="va">sedif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">pderT</span><span class="op">$</span><span class="va">pderiv</span> <span class="op">-</span> <span class="va">pderC</span><span class="op">$</span><span class="va">pderiv</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">vc</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">pderT</span><span class="op">$</span><span class="va">pderiv</span> <span class="op">-</span> <span class="va">pderC</span><span class="op">$</span><span class="va">pderiv</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      pT <span class="op">=</span> <span class="va">pderT</span><span class="op">$</span><span class="va">pbar</span>,</span>
<span>      pC <span class="op">=</span> <span class="va">pderC</span><span class="op">$</span><span class="va">pbar</span>,</span>
<span>      dif <span class="op">=</span> <span class="va">difb</span>,</span>
<span>      sedif <span class="op">=</span> <span class="va">sedif</span>,</span>
<span>      var <span class="op">=</span> <span class="va">sedif</span><span class="op">**</span><span class="fl">2</span></span>
<span>    <span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>est <span class="op">=</span> <span class="fu">difP</span><span class="op">(</span><span class="va">glmfit</span><span class="op">)</span><span class="op">$</span><span class="va">dif</span>, se <span class="op">=</span> <span class="fu">difP</span><span class="op">(</span><span class="va">glmfit</span><span class="op">)</span><span class="op">$</span><span class="va">sedif</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">paper_ge</span> <span class="op">&lt;-</span> <span class="fu">ge_var_paper</span><span class="op">(</span><span class="va">fit</span>, <span class="st">"trtp"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Point estimate"</span>, <span class="va">paper_ge</span><span class="op">$</span><span class="va">est</span>, <span class="st">"\nStandard error estimate"</span>, <span class="va">paper_ge</span><span class="op">$</span><span class="va">se</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Point estimate -0.06836399 </span></span>
<span><span class="co">## Standard error estimate 0.06071641</span></span></code></pre>
<p><strong>Version 2</strong>: using {margins} package</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"margins"</span>, quietly <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">margins_ge</span> <span class="op">&lt;-</span> <span class="fu">margins</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/margins/man/margins.html" class="external-link">margins</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">fit</span>, variables <span class="op">=</span> <span class="st">"trtp"</span>, vcov <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Point estimate"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">margins_ge</span><span class="op">)</span><span class="op">$</span><span class="va">AME</span>, <span class="st">"\nStandard error estimate"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">margins_ge</span><span class="op">)</span><span class="op">$</span><span class="va">SE</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code><span><span class="co">## Point estimate -0.06836399 </span></span>
<span><span class="co">## Standard error estimate 0.06071641</span></span></code></pre>
<p><strong>Version 3</strong>: using {marginaleffects} package</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"marginaleffects"</span>, quietly <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">marginaleffects_ge</span> <span class="op">&lt;-</span> <span class="fu">marginaleffects</span><span class="fu">::</span><span class="fu"><a href="https://marginaleffects.com/man/comparisons.html" class="external-link">avg_comparisons</a></span><span class="op">(</span><span class="va">fit</span>, variables <span class="op">=</span> <span class="st">"trtp"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Point estimate"</span>, <span class="va">marginaleffects_ge</span><span class="op">$</span><span class="va">estimate</span>, <span class="st">"\nStandard error estimate"</span>, <span class="va">marginaleffects_ge</span><span class="op">$</span><span class="va">std.error</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code><span><span class="co">## Point estimate -0.06836399 </span></span>
<span><span class="co">## Standard error estimate 0.06071641</span></span></code></pre>
<p><strong>Version 4</strong>: using SAS %Margins macro</p>
<pre class="sas"><code>%Margins(data      = myWork.trial01,
         class     = trtp,
         classgref = first, /*Set reference to first level*/
         response  = avaln,
         roptions  = event='1', 
         dist      = binomial,  
         model     = trtp bl_cov,
         margins   = trtp, 
         options   = cl diff reverse, 
         link      = logit);
    
** Store output data sets ; 
data myWork.margins_trt_estimates;
  set work._MARGINS;
run;
         
data myWork.margins_trt_diffs;
  set work._DIFFSPM;
run;</code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Point estimate"</span>, <span class="va">margins_trial01</span><span class="op">$</span><span class="va">Estimate</span>, <span class="st">"\nStandard error estimate"</span>, <span class="va">margins_trial01</span><span class="op">$</span><span class="va">StdErr</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Point estimate -0.06836399 </span></span>
<span><span class="co">## Standard error estimate 0.06071641</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="ye-et-al-2023">Ye et al (2023)<a class="anchor" aria-label="anchor" href="#ye-et-al-2023"></a>
</h3>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">beeca_ye</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_marginal_effect.html">get_marginal_effect</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">fit</span>, trt <span class="op">=</span> <span class="st">"trtp"</span>, method <span class="op">=</span> <span class="st">"Ye"</span>, </span>
<span>                                contrast <span class="op">=</span> <span class="st">"diff"</span>, reference <span class="op">=</span> <span class="st">"0"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Point estimate"</span>, <span class="va">beeca_ye</span><span class="op">$</span><span class="va">marginal_est</span>, <span class="st">"\nStandard error estimate"</span>, <span class="va">beeca_ye</span><span class="op">$</span><span class="va">marginal_se</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Point estimate -0.06836399 </span></span>
<span><span class="co">## Standard error estimate 0.0608836</span></span></code></pre>
<p><strong>Version 1</strong>: from <code>RobinCar</code> package</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"RobinCar"</span>, versionCheck <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"RobinCar"</span>, op <span class="op">=</span> <span class="st">"=="</span>, version <span class="op">=</span> <span class="st">"0.3.0"</span><span class="op">)</span>, quietly <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">robincar_ye</span> <span class="op">&lt;-</span> <span class="fu">RobinCar</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RobinCar/man/robincar_glm.html" class="external-link">robincar_glm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">data</span><span class="op">)</span>, response_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">formula</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>      treat_col <span class="op">=</span> <span class="st">"trtp"</span>, formula <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">formula</span>, g_family <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">family</span>,</span>
<span>      contrast_h <span class="op">=</span> <span class="st">"diff"</span><span class="op">)</span><span class="op">$</span><span class="va">contrast</span><span class="op">$</span><span class="va">result</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Point estimate"</span>, <span class="va">robincar_ye</span><span class="op">$</span><span class="va">estimate</span>, <span class="st">"\nStandard error estimate"</span>, <span class="va">robincar_ye</span><span class="op">$</span><span class="va">se</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code><span><span class="co">## Point estimate -0.06836399 </span></span>
<span><span class="co">## Standard error estimate 0.0608836</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<ul>
<li><p>Arel-Bundock V (2023). <em>marginaleffects: Predictions,
Comparisons, Slopes, Marginal Means, and Hypothesis Tests</em>. R
package version 0.14.0, <a href="https://vincentarelbundock.github.io/marginaleffects/" class="external-link uri">https://vincentarelbundock.github.io/marginaleffects/</a>.</p></li>
<li><p>Bannick M, Ye T, Yi Y, Bian F (2024). <em>RobinCar: Robust
Estimation and Inference in Covariate-Adaptive Randomization</em>. R
package version 0.2.0, <a href="https://CRAN.R-project.org/package=RobinCar" class="external-link uri">https://CRAN.R-project.org/package=RobinCar</a>.</p></li>
<li><p>European Medicines Agency. 2020. “ICH E9 (R1) addendum on
estimands and sensitivity analysis in clinical trials to the guideline
on statistical principles for clinical trials.” <a href="https://www.ema.europa.eu/en/documents/scientific-guideline/ich-e9-r1-addendum-estimands-sensitivity-analysis-clinical-trials-guideline-statistical-principles_en.pdf" class="external-link uri">https://www.ema.europa.eu/en/documents/scientific-guideline/ich-e9-r1-addendum-estimands-sensitivity-analysis-clinical-trials-guideline-statistical-principles_en.pdf</a></p></li>
<li><p>FDA. 2023. “Adjusting for Covariates in Randomized Clinical
Trials for Drugs and Biological Products. Final Guidance for Industry.”
<a href="https://www.fda.gov/regulatory-information/search-fda-guidance-documents/adjusting-covariates-randomized-clinical-trials-drugs-and-biological-products" class="external-link uri">https://www.fda.gov/regulatory-information/search-fda-guidance-documents/adjusting-covariates-randomized-clinical-trials-drugs-and-biological-products</a></p></li>
<li><p>Ge, Miaomiao, L Kathryn Durham, R Daniel Meyer, Wangang Xie, and
Neal Thomas. 2011. “Covariate-Adjusted Difference in Proportions from
Clinical Trials Using Logistic Regression and Weighted Risk
Differences.” <em>Drug Information Journal: DIJ/Drug Information
Association</em> 45: 481–93.</p></li>
<li><p>Magirr, Dominic, Mark Baillie, Craig Wang, and Alexander
Przybylski. 2024. “Estimating the Variance of Covariate-Adjusted
Estimators of Average Treatment Effects in Clinical Trials with Binary
Endpoints.” OSF. May 16. osf.io/9mp58.</p></li>
<li><p>SAS Institute Inc. “Predictive margins and average marginal
effects.” <em><a href="https://support.sas.com/kb/63/038.html" class="external-link uri">https://support.sas.com/kb/63/038.html</a></em> (Last
Published: 13 Dec 2023)</p></li>
<li><p>Thomas J. Leeper (2021). <em>margins: Marginal Effects for Model
Objects</em>. R package version 0.3.26.</p></li>
<li><p>Ye, Ting, Marlena Bannick, Yanyao Yi, and Jun Shao. 2023. Robust
Variance Estimation for Covariate-Adjusted Unconditional Treatment
Effect in Randomized Clinical Trials with Binary Outcomes.”
<em>Statistical Theory and Related Fields</em> 7 (2): 159–63.</p></li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alex Przybylski, Mark Baillie, Craig Wang, Dominic Magirr.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
